# Outline

## A Sybil Attack Detection Scheme for a Forest Wildfire Monitoring Application - FGCS 2018

Created by : Mr Dk.

2018 / 12 / 16 15:11

Nanjing, Jiangsu, China

---

### Introduction

无线传感器网络（_Wireless Sensor Networks, WSN_）由多个共同工作的微型的传感器结点组成

用于监控和采集感兴趣的数据

传感器结点的特征：资源受限

* 电池资源
* 计算资源
* 存储资源
* 通信带宽资源

通常部署在远程或敌方区域，执行监控和数据采集的工作

森林火灾 - 给人类和自然资源带来重大损失

* 通常发生在人类不能到达的较为危险的地区
* 需要进行敏感、快速的汇报

因此 _WSN_ 在森林火灾的预警中有较多的应用

* 部署密集的静态 _WSN_
* 基于热量数据和动物行为
* 基于捕获的数据和地理信息
* 贝叶斯网络
* 基于聚簇的分级网络

之前的所有研究主要集中在提高 _QoS_ 上

主要目标：采集时序要求严格的数据，并低延迟地报告给中心化的基站

没有针对安全方面的研究

由于 _WSN_ 没有人为干预，攻击者可以：

* 捕获警告数据包
* 恶意操纵捕获的数据包
* 传输误报警告
* 伪造传感器结点的身份（女巫攻击）

论文贡献：

1. 双重检测机制：低层的高能结点检测 + 高层的基站检测，保证女巫结点不参与簇头选举，保证女巫结点的数据在到达用户端前被探测并丢弃
2. 基于结点的能量消耗检测女巫结点
3. 进行女巫结点检测之后，基站选取最佳百分比数量的簇头，用于采集数据
4. 两种类型的数据查询：空间式 _spatial_ 采集和请求式 _on-demand_ 采集

---

### Related Work

本文使用基于聚簇的分层路由协议

已经存在的典型协议：

* _Low-Energy Adaptive Clustering Hierarchy (LEACH)_
* _Stable Election Protocol (SEP)_

结点被自组织为聚簇的形式

* 在每个簇中，簇头结点从成员结点采集数据
* 簇头结点聚集数据，并发送到基站
  * 在簇中，相邻结点通常检测到相近的数据，簇头在本地将数据进行汇聚能提高数据质量
* 协议按轮执行，在每一轮中将会选出新的簇头结点集合

在 _WSN_ 中，易出错的无线信道很容易暴露在各种各样的攻击之下

__女巫攻击__ - 攻击者伪造多个身份，使邻居合法结点相信他们有很多个邻居

目前已有的一些检测手段：

* _Radio resource testing_
  * 原理：
    * 一个无线信号不可能同时接收和发送
    * 一个物理结点伪造多个身份时，不可能使用一个信道
  * 需要结点的大量资源
  * 计算复杂，需要足够的内存空间
* 基于假设：在密集的结点网络中，两个结点具有完全相同的邻居集合的可能性非常小
  * 论文观点：伪造身份的邻居结点集合必然相同，因为它们关联在同一个物理设备上
* 基于 _RSSI_ 的解决方案
  * 虽然 _RSSI_ 是一个随时间变化且不可信的参数
  * 多个接收器的 _RSSI_ 比例可以用于检测女巫攻击
* 基于身份的检测
  * 用于女巫攻击或欺骗攻击
  * 用探测器检测调整传输功率的恶意结点，并定位结点，阻止它们参与网络

本文动机：

基于聚簇的分层路由协议（没有安全机制） + 女巫攻击检测 = 野外火灾传感器网络的女巫攻击检测

* 两种女巫攻击检测机制
* 中心化的簇头选择方法，选择基于：
  * 基于剩余能量
  * 之前的簇头选择历史
  * 每个结点的地理位置
* 不同类型的基于阈值的查询，用于在簇内采集数据
* 基站提供移动性以避免热点问题

---

### Design Considerations for a Wildfire Monitoring Application

#### Characteristics of burning wildfire scenario

野外火灾的特征因素：

* 可燃物
  * 草、干叶等
* 天气条件
  * 温度 - 燃点，阈值：`300℃`
  * 相对湿度 - 空气中的水分含量 - 阈值：`30%`
  * 风速 - 使可燃物干燥、传播火势 - 阈值：`12-15km/h`
* 地形
  * 上坡火势传播快
  * 下坡火势传播慢

#### Network parameters and design consideration

在 _WSN_ 中，相近的结点采集到几乎相同的数据

如果所有结点都将数据传输到基站，基站将充斥多份重复的数据

在野外火灾监控应用中，为了避免数据冗余

用户仅关心环境参数的阈值 - 便于用户根据环境条件快速采取行动

* 每个结点装备三个传感器——温度传感器、相对湿度传感器、风速传感器
* 每个结点一般处于睡眠状态，当捕获的数据满足阈值条件时被唤醒
  * 节约了结点能耗，延长了网络的生命周期
* 结点的行为由 __硬阈值__ 和 __软阈值__ 管理

硬阈值：触发传感器工作的最小值（传感器保持空闲或睡眠，直到硬阈值满足条件）

* 条件
  * 温度 - `100℃`
  * 相对湿度 - `40%`
  * 风速 - `8km/h`
* 之前的阈值指的是最大阈值（火灾可能已经发生）
* 用户需要在火灾发生前就被通知，因此硬阈值应比最大阈值小一些

软阈值：硬阈值的增加量

- 用户不关心与前一个警告数据包数据相似的警告数据包
- 当采集到的数据的增加量满足软阈值时，才向基站汇报

硬阈值、软阈值为用户提供了足够的采取提前措施的时间

---

### Detection of Sybil Attack in a Forest Wildfire Monitoring Application

#### Network Architectural Model

__网络层__ 支持 __女巫攻击检测__ 和 __聚簇算法__

* 在路由的过程中，检测出女巫结点的伪造身份，并组织它们进入簇头选择
* 伪造结点不会成为簇头，但依旧可以作为簇内成员参与网络
* 但最终伪造结点的数据不会被送到用户端

__应用层__ 支持 环境参数采集

#### Network Deployment Model

* _Normal node_ - _2 joules_ 剩余能量
* _High-energy node_ - _5 joules_ 剩余能量

网络中的结点越多

* 传输的包数量越多
* 高端到端延时、重传、丢包、网络内处理、网络拥塞、_QoS_ 退化
* 网络资源利用、能量消耗大

#### Detection of Sybil Attack

确保只有合法结点才能被选为簇头结点

女巫结点被排除在簇头选择之外，维护网络的：

* 稳定性
* 有效性
* 能量消耗

如果女巫结点成为簇头，它们可以丢弃用于决策的数据包

伪造自己的数据包，或只传输不重要、没有用的数据包

使用户误认为没有火灾发生，或使用户误认为火灾发生在另一个地方

本文提出了两种不同的方法，用于女巫结点的检测

##### RSSI-based Sybil Attack Detection

正常结点和女巫结点在物理上和功能上相同

每个结点向两个最近的 _high-energy_ 结点广播 __控制包__，包含：

* 结点身份
* 结点剩余能量

算法过程：

* 两个 _high-energy_ 结点 _hen1_ 和 _hen2_ 分别计算对应某个结点身份的 _RSSI_
* _hen1_ 和 _hen2_ 利用自己的控制包交换对方计算出的 _RSSI_
* 得到两个结点计算出的 _RSSI_ 的比值
* 在下一个时刻，再次得到一个 _RSSI_ 比值
* 如果两次 _RSSI_ 比值的差值接近 _0_，则说明出现了女巫攻击

由于结点数目较多，如果将控制包直接发给基站将造成很大的延时

因此这一算法在 _high-energy node_ 完成

##### Residual Energy-based Sybil Attack Detection

与合法结点不同，女巫结点需要传输多个控制包来伪造假身份

_High-energy node_ 在收到控制包后，将其中的结点身份和剩余能量存储在本地

女巫结点的控制包：

* `I1, E`、`I2, E`、`I3, E`、`I4, E`

如果存在剩余能量相同，身份不同的结点，说明存在女巫攻击

* 如果一个女巫结点的剩余能量和一个合法结点的剩余能量相同，则也会引发攻击警告
  * 为了避免这种情况，将剩余能量的精度精确到小数点后五位，这样出现这种情况的概率很小很小

#### Cluster-based Hierarchical Network

在女巫攻击检测之后，进行基于聚簇的网络组建

分为以下两个阶段

##### Set-up phase

在女巫攻击检测期间，合法结点和女巫结点都参与了网络通信

经过检测，_high-energy node_ 检测并屏蔽了一部分女巫结点的通信（也可能漏掉了一部分）

_high-energy node_ 产生控制包向基站报告所有结点的身份和剩余能量（包括合法结点和漏掉的女巫结点）

基站维护一个数据库，包含了网络内所有合法结点的信息

所以在女巫攻击检测中的漏网之鱼最终会在基站被检测出来

由于是基站来决定选择簇头，所以这些女巫结点会被隔离在簇头选择之外

* 但不能阻止它们参与通信，因为 _high-energy node_ 认为它们是合法结点

两个基站是 __资源富裕__ 的实体，且完全同步，参与 __最佳百分比__ 数量的簇头选举

基站首先计算所有合法结点的平均剩余能量（所有女巫结点已被隔离在外）

* 候选结点的剩余能量是否 `≥` 平均剩余能量？
* 候选结点是否在过去的 `1/p` 轮中担任簇头？
  * `p` 是最佳的簇头数量百分比，设定为 `n` （所有合法结点数量）的 `5%`
* 候选结点的剩余能量是否高于同一地理位置附近的候选结点的剩余能量

基站选定簇头集合以后，发送任命包，包中包含：

* 簇头的身份
* 用户端的 _spatial queries_
  * 包含触发重要事件的条件 - 阈值

簇头收到任命包后，向周围结点广播以组建聚簇

* 广播包中包含簇头的身份和 _spatial queries_

每个邻居结点会收到多个簇头的广播，但只会选择一个信号最强的簇头关联

每个结点开始进入睡眠，只有在满足触发条件时才会唤醒

用户端可以随时修改 _spatial queries_ 中的参数

##### Steady-state phase

合法结点或女巫结点产生警告包，向簇头汇报事件

簇头采集并汇总警报，并传输到最近的 _high-energy node_

_High-energy node_ 将数据传输到基站

基站在收到数据后，丢弃身份与已有数据库不匹配的数据包

基站向特定位置的结点（一小部分）发送 _on-demand queries_

* _on-demand queries_ 只会发送给合法结点，因为基站知道所有合法结点的信息

结点存储这些 _queries_，并每隔一段时间根据特定的条件发送警告包

一次 _set-up phase_ 和 _steady-state phase_ 的完成被认为是一轮

---

### Experimental Results and Analysis

#### Detection of Sybil Attack

#### Accuracy of Wildlife Monitoring Application

#### Lifetime of the Network

##### Analysis of Energy Consumption

##### Average Size of the Clusters

---

### Conclusions

_High-energy node_ 和 _base station_ 的双重检测

* _high-energy mode_ 的检测包含 _RSSI_ 和 _residual energy_ 两部分

防止女巫结点参与簇头选举

防止女巫结点的伪造数据到达用户端

网络组建与簇头选举的方法

_Spatial queries_ 和 _On-demand queries_ 两种查询方式

问题：

簇头选择算法的复杂度高，开销大

---

### Summary

没什么收获。。。

可能是对 _WSN_ 了解不多

我觉得用到的方法都比较原始。。。

---

