# Outline

## Synesthesia - Detecting Screen Content via Remote Acoustic Side Channels - S&P 2019

Created by : Mr Dk.

2019 / 04 / 08 20:08

Nanjing, Jiangsu, China

---

## Abstract

电脑屏幕发出的微弱声学噪声

可被用于推断屏幕上显示的内容

采集方式：

* 屏幕或网络摄像头内置的麦克风
* 放在屏幕附近的麦克风
* 放在电脑附近的智能手机

采集到的声音可能会在受害者没有意识的条件下发送到别处

* 电话会议
* 录音收集

这种侧信道可被用于实时检测：

* 屏幕上的文字
* 屏幕虚拟键盘上的用户输入

本文还揭示了攻击者如何利用视频电话中获取到的声音

推断受害者一端是否正在浏览网页

以及哪一个网页正在显示在屏幕上

---

## Introduction

物理侧信道攻击通过测量一些在物理环境中未被察觉到的影响因素

破坏一些密码实现的安全机制

试图使用侧信道攻击攻击者们面对如下挑战：

* 为了进行物理上的测量，必须在物理上接近目标计算机
  * 有时，物理接近受到限制，接近会被屏蔽或发现
* 因此攻击者会试图控制已经距离目标很近的一些传感器
  * 比如在目标电脑附近的智能手机上部署恶意 APP，控制内置的麦克风

本文提出了第三种可能：

是否存在一种侧信道，攻击所必要的物理测量已经完成

且被不可信的一方和受害者一方共享

从而使受害者没有理由怀疑他们在不知不觉中泄露了隐私信息

本文研究发现了新的物理侧信道：

__内容依赖的 LCD 屏幕声音泄露__

泄露的声音信息可以被任意的麦克风捕获

而用户通常会共享通过这些麦克风捕获的声音

* 电话会议等

而且，相关的声音较为模糊、频率较高

* 人耳几乎听不到
* 因此受害者很难意识到泄露

用户通常会在里屏幕比较近的地方放置摄像头

从而为攻击者提供了更多的机会

### Our Results

通过实验，验证了不同厂家、不同型号的 LCD 屏幕

在最早 16 年前的屏幕，到现在的最新屏幕，都存在泄露问题

泄露的捕获来源：

* 网络摄像头的麦克风
* 屏幕附近的智能手机
* _Smart Speaker_ 虚拟助手
* 一些屏幕内置的麦克风
* 距离屏幕背面 10 米的专用麦克风

泄露语音的观测和分析途径：

* 已存档的语音记录
* _Google Hangouts_ 视频会议
* 虚拟助手在云端保存的语音记录

攻击目标：

1. 提取屏幕上显示的文本
2. 区分屏幕上正在进行视频会议还是浏览网页，以及区分屏幕上显示的网页
3. 提取 Ubuntu 屏幕键盘中输入的文本（说明软键盘也存在声学侧信道）

实现方式：定制的信号处理 + 深度神经网络

泄露特性和训练得到的神经网络分类器，对于不同型号的屏幕具有通用性

且该种攻击对办公室等级的噪声具有较好的鲁棒性

### Related Work

物理侧信道的分类：

* 电磁辐射
* 能量消耗
* 地面电位浮动
* 时间
* 键盘发出的声音
* 打印机和 CPU 的功耗

之前有关声学侧信道的研究

主要利用笔记本电脑中的线圈发出的声音

而没有关注显示器的声音泄露

---

## Characterizing the Signal

本章探索了计算机显示器泄露的声学信号

并试图描绘泄露的声音和显示内容之间的联系

### Background and Experimental Setup

#### Image Rendering Mechanism

显示屏显示一个 `l * n` 的像素矩阵

* 每一个像素被进一步分为 R、G 和 B 三个子像素
* 每个子像素的强度由一个 `0` 到 `255` 的整数表示
* 使每个像素的颜色都能够通过 `24` 位的整数独立表示

显示屏的刷新率

* 决定了每秒需要被显示的图像被送至显卡多少次
* 屏幕通过从上到下迭代每一行，每行从左到右，渲染接收到的图像
* 屏幕总是会重新渲染显示的图像每秒 `r` 次，即使显示的图像没有发生变化
* `30 Hz` / __`60 Hz`__ / `120 Hz`

#### Experimental Setup

通过麦克风从各式各样的屏幕上采集声音信息

前置放大器、放大器

USB 声卡，采样频率 `192 kHz`

* 模拟信号数字化
* 产生 `.wav` 文件

#### Vsync Probe

为了便于采集，有时候需要利用对应每次刷新开始时的触发信号

* 将 VGA 接口的垂直同步线暴露出来
* 在每次刷新前，会带有 `0.5V` 的脉冲

### Exploring the Leakage Signal

#### Distinguishing Various Images

从分析简单的重复图片开始

* 写了一个简单的程序
* 能够显示水平、等宽的黑白交替的条纹 - _Zebras_
* _Zebra_ 的 _period_ 定义为两个相邻黑色条纹的距离

记录显示不同 _Zebra_ 的声音

实验结果显示，不同的 _Zebra_ 显示了明显不同的变化

此外，还测试了很多不同的显示器

不管新旧，这种泄露都存在

#### Acoustic or EM

证明获得的信号确实是由屏幕泄露的声音信号引起

而不是麦克风意外捕获的电磁辐射

实验中，在麦克风面前放置一块吸声材料

麦克风被物理上隔离后，记录到的信号明显衰弱了

证明了观测到的信号确实是声学信号

#### Physical Leakage Source

在发现了泄露信号的声学特征后

作者试图在屏幕内部定位它的源头

选用了一款内部设计较为简单的屏幕

除了 LCD 面板自身，还包含两个主板：

* Digital board - 实现监控器逻辑、图像渲染功能
* Power supply board - 为数字电路提供稳定的电压和背光，但不直接处理屏幕内容

为了定位引发声音泄露的组件

作者在 LCD 上显示 _Zebra_ 的同时

在两个 board 的不同位置进行了测量

最终将问题定位在了 Power supply board 上

* 负责为 Digital board 提供能量
* 无法在一个单一组件上进一步寻找源头

#### Leakage Mechanism

作者推测，显示器数字电路产生的瞬时激励功率

随着与一个与显示内容有关的函数变化

从而影响了 Power supply board 的电力负载

导致了振动，从而产生了声音

然而，信号的准确增殖过程很难精确追踪：

* 信号调制对电路的拓扑、布局和环境有很复杂的依赖关系

#### Analyzing the Leakage Frequency

已经认证了不同的图像产生不同的声音泄露

接下来寻找显示的图像和产生的泄露信号之间的联系

假设渲染一个独立的像素，会产生与像素颜色有关的声音

由于整个屏幕每秒会被重新刷新 `60` 次

显示像素的空间周期性变化，会产生强烈的频率特征

> 比如，显示一个  period 为 `16` 像素的 _Zebra_
>
> 垂直分辨率为 `1050` 像素
>
> 那么每次刷新屏幕，将会产生 `1050/16*2 = 131.25` 次颜色变化
>
> 由于每秒会进行 `60` 次刷新
>
> 会产生 `131.25*60 = 3937.5 Hz` 的频率

### Signal Analysis in the Time Domain

假设：像素线的强度直接显示了泄露信号

使用一个屏幕直接显示了 period 为 `21` 的 _Zebra_

* 条纹之间的颜色变化变得平滑，服从正弦曲线
* 将中间三分之一部分替换为纯黑色

在 _Zebra_ 的自然频率产生了严重的泄露

在时间域上对声音信号进行绘制

* 中间三分之一部分的振幅明显较低
* 调整中间黑色区域的尺寸，低振幅区的面积也随之增加或减少

结论：泄露声音信号的瞬时振幅是像素行亮度等级的准确估计

### Analyzing Amplitude Modulated Signals

在对声音信号使用 `27.5-38kHz` 的带通滤波器后

发现信号振幅和像素显示的颜色具有明显的相关性

* 较黑的像素行对应较高的信号振幅

#### Leveraging the Modulated Signal

由于调制信号的载波频率比很多自然产生的声音信号的频率高很多

因此可以被用于提取一个相对干净版本的屏幕映像

提取过程产生的输出是一个 `192kHz` 的时间序列向量

在录制声音几秒后

在载波频率附近进行带通滤波后

通过减去序列的平均值来进行振幅解调

然后将样本划分为段，每段包含一次屏幕刷新周期的声音泄露信息

#### Denoising Challenges

为了减少噪声，本文的方法是分段取平均

为了使平均后的噪声能被去除

需要每一段在长度和相位上互相接近

* 本文的方法是，由于已知屏幕刷新率，将信号划分为 `1/60s` 的段
* 每一段对应一个刷新周期

带来了以下两个挑战：

* Drift
* Jitter

使用相关性的方法来解决：

任意选择一段作为 _master chunk_

让其它所有段根据 _master_ 的相位对齐

* 当两个段的相位对齐时，相关系数最大

### Our Denoising Approach

需要一个对于 drift 和 jitter 鲁棒性较好的算法

使每一个段都对应于每个刷新周期的特定相位

采样速率表示为 `fs`

---

## Attack Vectors

### Close-range and At-distance Attacks

攻击者使用了高端的麦克风

#### Experimental Setup

对于长距离的攻击场景

麦克风被安装在 `10` 米以外，背对着屏幕

为了仿真真实的攻击场景

录音在一个办公室环境中进行

* 一些附近设备的噪声
* 偶尔有人声

作者预计讲话声音不会干扰

因为大部分泄露信号的频率远高于讲话频率

### Phone Attack

考虑一个智能手机放在屏幕附近的情况

使用手机内置的麦克风进行录音

攻击场景：

* 攻击者可以使用他自己的手机录制背对着攻击者的屏幕的声音（比如会议）
* 攻击者也可以在受害者没有意识的情况下，通过流氓 APP 远程录制声音

#### Experimental Setup

Amazing MP3 Recorder app - `start recording` & `stop recording` interface

使用 Android 的跨 APP 通信机制唤起录制

录音依旧在办公室环境中录制

#### Demonstrating Leakage

发现使用 `192kHz` 能够很好得捕获声音泄露

进行了两个场景的实验：

* 手机背对着屏幕（模仿会议场景）
* 手机自然放置在屏幕附近的桌子上（模仿远程攻击场景）

对于后者，信号虽然有所减弱，但在频谱图上依旧清晰可见

对于前者，录制的效果很好，并可以媲美高端录音设备的结果

### VoIP Attacker

远程攻击者能够通过视频会议服务进行攻击

只要网络摄像头没有对准屏幕或者屏幕的一些镜面反射

目标会认为，视频电话中的远程参与者无法收集本地屏幕上的内容

然而，攻击者接收到了目标的麦克风录制的语音

* 麦克风通常放置在屏幕附近
* 甚至嵌入在屏幕内部

这些麦克风捕获到了屏幕的声音泄露

视频会议服务以数字信号的方式将这些声音转发

远程攻击者能够分析这些信号，并提取屏幕上的内容

#### Experimental Setup

使用受害者自己的麦克风（嵌入在网络摄像头内）录制语音并发送到远程

录制在办公室环境内完成

受害者的麦克风自然放置在屏幕旁

在受害者和攻击者之间建立视频连接

在攻击者一方，将声卡的所有输出重定向到本地设备存储

#### Observing the Leakage

当显示交替的 Zebra 图形时进行测量

发现：

1. 商用的麦克风能够捕获泄露

2. 无论何种方式放置的麦克风采集到信息都足够用于捕获

   甚至一些屏幕的内置麦克风也足够用于采集泄露

3. 即使语音是通过视频会议的软件进行传输的，泄露问题依旧存在

### Virtual Assistant / "Smart Speaker" Attack

用户屏幕内容可能被语音助手等程序泄露：

* Alexa assistant - Amazon
* Google assistant - Google

这些语音助手一经配置，设备会在后台不断采集语音，包括附近屏幕泄露的声音

一旦检测到唤醒词，进入 attention mode 识别并回应命令

从唤醒阶段开始，一直到之后交互停止之前的录音

将被上传到云服务器（用于学习用户的声音，提升识别准确性）

作者将 Google 的家庭设备放置在显示斑马条纹的屏幕旁边

并通过 _Hey Google_ 唤醒设备，并维持录制一段时间

最终，作者从 Google 的服务器上获取到了录制的语音

结果是，Zebra 条纹清晰可见

对于 Amazon 的服务，也得到了类似的结果

---

## On-screen Keyboard Snooping

此攻击的目标是从屏幕键盘上提取单词或句子

实验包含了水平布局和垂直布局的键盘

屏幕键盘被所有的主流操作系统提供

也会被一些网页采用

作为密码输入的安全机制

使用屏幕键盘也可以用于防止通过声音探测物理键盘输入的攻击者

本文证明，屏幕上的输入也可以被泄露出的声音推断出来

### Machine Learning Attack Methodology

两个阶段：

1. off-line
   * 攻击者采集给定型号的屏幕的训练数据
   * 使用机器学习的方法，区分屏幕的内容
2. on-line
   * 攻击者录制攻击场景下屏幕的实际声音
   * 使用模型来推断屏幕上的内容

#### Limitations

机器学习模型对于攻击数据比对于训练数据来说更敏感

所以获取训练数据的过程必须和实际攻击场景类似

此外，不同的显示器对于相同的图像会发出不同的声音模式

因此攻击者必须准确获知用户的显示器模型，并有能力获得模型

#### Why Machine Learning

神经网络，尤其是卷积神经网络

十分擅长时间序列数据的监督学习

即使存在很多噪声

#### Using Classifiers

部署了一个基于 CNN 的架构

分类器的输入是一个样本，表示为一个时间序列向量

分类器的输出是一个概率向量，分别为每一个类的概率

一个样本的预测类是概率最高的那个类

#### Simpler ML Architectures

作者调整了神经网络以提升速度和准确率

大部分数据足够清晰

可以用简单的逻辑斯特回归模型

### Attack Simulation and Results

#### Data Collection and Preprocessing

采用了 close-range 设定和 smart-phone 设定

在屏幕上显示鼠标点击软键盘的截图

使用了 Ubuntu 的屏幕键盘，手机式的键盘布局

对于每一种攻击设定，在字母表的 26 个字母上迭代 100 次

在每一次迭代中，对于每一个输入

在按键被按下时，采集 `0.5s` 的样本

将这些样本分为 90% 的训练集和 10% 的验证集

作者也录制了一些在虚拟键盘上输入的单词的样本

* 在常用的 1000 个英语单词中随机选出 50 个
* 单词中的每一个字母是连续输入的，间隔 3 s

#### Training Procedure

在键盘上的每一次按键都会导致一个特殊的图像显示在屏幕上

可以通过训练分类器，识别不同的字母输入

然而，有一些按键在虚拟键盘上是完全水平对齐的

作者将这些按键归为一类

因此所有的 label 为：

* `b` `c` `m` `n` `p` `v` `x` `z` `aq` `sw` `de` `fr` `gt` `hy` `ju` `ki` `lo` `space`

#### Testing Procedure

对一段长度的样本进行分类

输出每个样本对应的概率向量

从头至尾进行遍历

输出连续出现 `15` 次（smart-phone）或 `35` 次（close-range）的 label

假设 CNN 一直预测正确，将会产生对应于在屏幕上输入的 label 序列

然而，这些序列不区分：

1. 属于同一个 label 的字母
2. 属于同一个 label 但连续输入的字母

为了消除这种问题带来的影响

作者遍历了词典中的 `102000` 个单词

* 计算每个单词对应的输出模式
* 并与预测得到的序列进行比对

返回匹配的词语

#### Results

分类器达到了 100% 的准确率

#### Portrait VS Landscape Layout

竖屏模式下，更易于分辨

---

## Text Extraction

此种攻击中，攻击者的目标是提取被攻击屏幕上显示的文本

* 可被用于提取各种各样的敏感数据
  * 认证信息
  * 隐私信息
  * 搜索查询
  * 财务信息

作者假设攻击者已经知道显示器上有内容，但不知道具体的信息

#### Data Collection and Preprocessing

采用了 close-range 的设定

采集了 10000 个样本，每个样本 5 s

在每个样本中，随机选择的不同字母序列显示在屏幕上

* 序列的长度从 `{3, 4, 5, 6}` 中随机选择
* 字母全部大写，宽度为 `175` 像素
* 将每个样本和对应的字母序列关联
* `90%` 用于训练，`10%` 用于验证

另外采集了一个测试集，共 `100` 个样本，每个长度的样本 `25` 个

#### Training Procedure

为每一个字母位置建立了一个分类器

每个字母位置会在刷新周期期间的特定时间段内被渲染

#### Testing Procudure

为了预测输入的单词

首先，移除非字母字符，截断或用空格填充单词

因此所有的单词都是 6 个字符长

每个分类器输出预测每个字母的概率

将概率加起来，作为单词的预测概率

#### Results

`88%-98%`

#### Error Analysis

会将一些常用词和很少使用的词用混

* 采集随机性较小的训练数据
* 为更经常使用的单词设定优先级

---

## Website Distinguishing

在这种攻击中，攻击者的目标是判断受害者是否正在进入一个特定的网站

或只对受害者的网页浏览习惯感兴趣

在 VoIP 设定中，攻击者可能对视频电话中的另一方的屏幕上的显示内容感兴趣

* 比如，对方是否一直讲视频 app 最大化
* 还是正在浏览别的什么网页

本文提出的方法能够准确区分屏幕上的内容

虽然网页上会存在一些动态变化的内容（广告）

分类器依旧能够获得高准确率（暗示了网页的整体布局是相对静态、稳定的）

### Using the Modulated Signal

#### Data Collection and Preprocessing

选择了 `97` 个较为流行的网站

对网页集合迭代 100 次

在每一次迭代中，打开 Chrome 的浏览器窗口

并录制 `5s`

对每个网页采样 100 次

使用 `70%` 作为训练集，用 `30%` 作为验证和训练

#### Machine Learning and Results

我们的目标是寻找 `97` 个显示在屏幕上的网站

大约有 `8%` 的 close-range 设定样本和 `16%` 的智能手机设定样本在处理时报错

说明其中包含了过多的噪声

对于 close-range 设定，验证集的准确率到达了 `97.09%`

对于 smartphone 和 at-distance 的测试，准确率分别为 `91.2%` 和 `90.9%`

### Attack through a Hangouts Call

假设攻击者和受害者共享一个 Hangouts 视频聊天会话

来自受害者环境的声音直接传输到了攻击者一方

利用泄露的声音，攻击者的目标是

区分出受害者是否正在浏览网页

且区分出他们正在浏览哪个网页

#### Data Collection and Preprocessing

作者在 11 个打开的窗口中迭代地切换受害者屏幕的前景窗口

* 视频聊天窗口
* 排名前十的网站

每个样本采样 `6s`

将样本分为 `70%` 的训练集和 `30%` 的验证集

#### Machine Learning and Results

目标是找出 10 个网站中的哪一个网站显示在屏幕上

分类器达到了 `96.5%` 的准确率

---

## Cross-screen Attack

之前的攻击中，分类器都是由来自受害者屏幕的记录训练的

* 攻击者需要有机会在受害者屏幕上显示一张图片
* 并录制一段声音

如果这些前提不能被满足：

* 攻击者可以用同一型号的不同屏幕进行训练
* 或使用完全不同的型号训练

评估了攻击的通用性

分类器在不同的屏幕上被训练，应用到另一个屏幕上

#### Data Collection

使用了总共 10 个屏幕：

* `5` 个 _Dell WD-04_
* `2` 个 _Dell WD-05_
* `2` 个 _DellB_
* `1` 个 _Soyo_

屏幕的集合同时满足了相似性和区别性：

* `9` 款屏幕来自 _Dell_ 家族
* 也包含了多种不同型号

对于每一个屏幕，采集了 50 条记录，每条 5s

#### Data Preprocessing

对于每一个屏幕，评估每一个训练集合

* 单独每一个屏幕（包括该屏幕自身）
* 每一个同型号的集合
* _Dell4_、_Dell5_、_DellB_ 的混合集合，除了该屏幕自身
* 所有的屏幕，除了该屏幕自身
* 所有除了 _Soyo_ 的屏幕

#### Machine Learning and Results

对于每一个屏幕

* 使用对应的训练集合进行训练
* 使用该屏幕的数据作为测试数据

#### Observations

1. 使用同一家族的更多屏幕有利于提高同一家族内屏幕的通用性
2. 同一型号之间的通用性比不同型号之间的通用性好
3. 跨厂家的通用性较差

#### Conclusions

无法从物理上接近屏幕的远程攻击者会受到屏幕间通用性的限制而影响精确率

为了提高通用性

攻击者可以使用同一型号的多个屏幕

或甚至使用同一厂家生产的相似型号的屏幕

来进行模型的训练

同时，这一训练过程可以只做一次，离线，并被用于之后的多次攻击

该模型也可以用于：

* 录制一段受害者屏幕的声音
* 判断出受害者屏幕的具体型号

---

## Mitigations

### Elimination

厂家应当认真评估和实现它们的设计

使电路组件的振动最小化

### Masking

声学噪音产生器可被用于掩盖信号

设计、制造的成本升高了

有可能会对人耳带来影响

### Shielding

对屏幕进行声学屏蔽

但可能会导致没有足够的空气循环用于散热

### Software Mitigations

改变屏幕显示的内容来掩盖泄露

本文的攻击严重依赖于神经网络分类器

它们很容易被攻击数据给误导

---

## Conclusion

报告了新型的物理侧信道 - 屏幕显示内容的声学泄露

本文提出了强大的攻击方式，提取了高度重要的信息：

* 屏幕上的文本
* 屏幕上的键盘输入

这种泄露很危险，因为攻击者可以从合法的信道中仅获得编码后的声音

且攻击者可以不需要在物理上接近受害者的屏幕

就可以获取这些信息

---

